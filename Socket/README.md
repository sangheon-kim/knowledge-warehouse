# 웹소켓

- WebSocket은 웹에서 양 방향 통신을 지원하며, 그에 따른 실시간 서비스를 구현하기에 적합한 기술입니다.
- HTTP 실시간 통신 방식(COMET)인 폴링(Polling), 롱폴링(Long Polling), 스트리밍 방식 보다 월등한 성능 차이를 보여준다.

## COMET 방식

### 1. 폴링(Polling) 방식

- 브라우저가 일정한 주기로 HTTP 요청을 보내는 방식.
- 보통 실시간 데이터의 업데이트 주기는 예측이 어려워, 그에 따른 불필요한 서버 및 네트웤 부하가 늘어난다.

### 2. 롱폴링 방식

- HTTP 요청 시 서버는 해당 요청을 일정 시간 동안 대기 시킨다. 만약, 대기 시간 안에 데이터가 업데이트되었다면, 그 즉시 클라이언트에게 응답을 보내고 전달받은 데이터를 처리 후 서버로 재요청을 시작한다.
- 데이터 업데이트가 빈번한 경우엔 폴링에 비해 성능상 이점이 크지 않습니다.

### 3. 스트리밍 방식

- 서버는 지속적인 업데이트를 위해 무한정 요청을 대기 시키며, `chunked` 기반 메시지를 이용하여 응답 시 연결을 유지 시킨다.

### 정리

- COMET 방식은 데이터 전송 과정에서 불필요한 많은 양의 네트웤 오버 헤더를 발생 시키며, 연결 대기 시간에 따른 성능 저하도 추가로 발생한다.
  또한, 단방향(반이중 통신)통신인 양방향 통신(이중 통신)으로 구현하기 위한 별도의 복잡한 개발 비용도 발생한다.

## HTML WebSocket

- 이전 HTTP 통신과는 달리 클라이언트와 서버 간 양방향 통신이 가능하여, 이때 네트웤상의 메시지는 0x00바이트로 시작해서, 0xFF 바이트로 끝나고, 그 사이에는 UTF-8 데이터가 채워지게 된다.

### 폴링 방식과 WebSocket 방식

#### Polling 방식

- HTTP 요청/응답 시마다 아래와 같은 HTTP 헤더 데이터들이 전달되며, 그에 따른 네트웤 오버헤드가 발생한다.

#### Websocket 방식

- WebSocket 방식은 HTTP 방식과 달리 불필요한 요청/응답 헤더 데이터가 존재하지 않는다.

### 전송 대기시간 비교

#### 폴링(Polling) 방식

- 서버 응답 후 요청에 대한 대기시간이 추가로 발생한다.
- 즉, 클라이언트 요청부터 서버 응답까지 50ms 걸렸으며, 서버 응답 후 재요청을 만들기 위한 추가적인 대기시간이 걸린다.

#### WebSocket 방식

- 최초 서버와 연결 후, 연결이 그대로 유지되므로 클라이언트가 재요청을 보낼 필요가 없다.
- 즉, 추가적인 대기시간이 발생하지 않는다.

cc) https://valuefactory.tistory.com/263
